# Real-time Notification System ğŸ””

## à¸ à¸²à¸à¸£à¸§à¸¡
à¸£à¸°à¸šà¸šà¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹à¸šà¸š Real-time à¸ªà¸³à¸«à¸£à¸±à¸š Admin à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰ Socket.io à¹€à¸à¸·à¹ˆà¸­à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸ªà¸³à¸„à¸±à¸à¹ƒà¸™à¸£à¸°à¸šà¸š

## à¸Ÿà¸µà¹€à¸ˆà¸­à¸£à¹Œà¸«à¸¥à¸±à¸

### ğŸ¯ à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸—à¸µà¹ˆà¸£à¸­à¸‡à¸£à¸±à¸š
1. **à¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š** - à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š
2. **à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¹ƒà¸«à¸¡à¹ˆ** - à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹ƒà¸«à¸¡à¹ˆ
3. **à¸šà¸£à¸´à¸©à¸±à¸— EPC à¹ƒà¸«à¸¡à¹ˆ** - à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸šà¸£à¸´à¸©à¸±à¸— EPC à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™
4. **à¸«à¸™à¹ˆà¸§à¸¢à¸‡à¸²à¸™à¹ƒà¸«à¸¡à¹ˆ** - à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸«à¸™à¹ˆà¸§à¸¢à¸‡à¸²à¸™à¸£à¸±à¸à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™
5. **à¸œà¸¹à¹‰à¸›à¸£à¸°à¸ªà¸²à¸™à¸‡à¸²à¸™à¹ƒà¸«à¸¡à¹ˆ** - à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µ Sale/Coordinator à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™
6. **à¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¹ƒà¸«à¸¡à¹ˆ** - à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¹‚à¸„à¸£à¸‡à¸à¸²à¸£à¹ƒà¸«à¸¡à¹ˆ

### âœ¨ à¸„à¸¸à¸“à¸ªà¸¡à¸šà¸±à¸•à¸´
- âœ… Real-time notifications (à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡ refresh à¸«à¸™à¹‰à¸²)
- âœ… à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸‰à¸à¸²à¸° Admin role à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- âœ… à¹à¸ªà¸”à¸‡à¸ˆà¸³à¸™à¸§à¸™à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸—à¸µà¹ˆà¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸­à¹ˆà¸²à¸™
- âœ… Toast notification popup
- âœ… Notification dropdown à¸—à¸µà¹ˆà¸ªà¸§à¸¢à¸‡à¸²à¸¡
- âœ… à¸£à¸­à¸‡à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸³ mark as read
- âœ… à¸¥à¸šà¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹à¸•à¹ˆà¸¥à¸°à¸£à¸²à¸¢à¸à¸²à¸£
- âœ… à¸¥à¸šà¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
- âœ… à¸­à¹ˆà¸²à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸à¸£à¹‰à¸­à¸¡à¸à¸±à¸™
- âœ… à¹à¸ªà¸”à¸‡à¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Socket

## à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œ

### Backend
```
backend/
â”œâ”€â”€ socket.js                           # Socket.IO server à¹à¸¥à¸° notification helpers
â”œâ”€â”€ server.js                           # Socket initialization
â””â”€â”€ routes/
    â”œâ”€â”€ auth-mysql.js                   # Login/Register notifications
    â”œâ”€â”€ epc.js                          # EPC registration notifications
    â”œâ”€â”€ agencies.js                     # Agency registration notifications
    â””â”€â”€ coordinators-mysql.js           # Coordinator registration notifications
```

### Frontend
```
src/
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ NotificationContext.jsx         # Notification state management
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ NotificationBell.jsx            # Notification UI component
â”‚   â””â”€â”€ AdminDashboard.jsx              # Dashboard with notification bell
â””â”€â”€ App.jsx                             # NotificationProvider wrapper
```

## à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡

### Dependencies à¸—à¸µà¹ˆà¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸¥à¹‰à¸§

**Backend:**
```bash
cd backend
npm install socket.io
```

**Frontend:**
```bash
cd /srv/evosolusiont
npm install socket.io-client
```

## à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™

### 1. à¸ªà¸³à¸«à¸£à¸±à¸š Admin
à¹€à¸¡à¸·à¹ˆà¸­ Admin à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š:
1. Socket.io à¸ˆà¸°à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
2. à¸ˆà¸°à¹€à¸«à¹‡à¸™à¹„à¸­à¸„à¸­à¸™à¸£à¸°à¸†à¸±à¸‡à¸”à¹‰à¸²à¸™à¸‚à¸§à¸²à¸šà¸™à¸‚à¸­à¸‡ navbar
3. à¸ˆà¸°à¸¡à¸µ Badge à¹à¸ªà¸”à¸‡à¸ˆà¸³à¸™à¸§à¸™à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸—à¸µà¹ˆà¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸­à¹ˆà¸²à¸™
4. à¸„à¸¥à¸´à¸à¸—à¸µà¹ˆà¹„à¸­à¸„à¸­à¸™à¸£à¸°à¸†à¸±à¸‡à¹€à¸à¸·à¹ˆà¸­à¸”à¸¹à¸£à¸²à¸¢à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”

### 2. à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸‚à¸­à¸‡à¸£à¸°à¸šà¸š

#### à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š:
```javascript
// à¸ªà¹ˆà¸‡à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹„à¸›à¸¢à¸±à¸‡ Admin à¸—à¸¸à¸à¸„à¸™
const notification = createNotification(
  NotificationTypes.USER_LOGIN,
  `${user.firstName} ${user.lastName} à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š (${user.role})`,
  { userId: user.id, email: user.email, role: user.role }
);
sendNotificationToAdmins(notification);
```

#### à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸à¸²à¸£à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™ EPC:
```javascript
const notification = createNotification(
  NotificationTypes.EPC_REGISTER,
  `à¸šà¸£à¸´à¸©à¸±à¸— EPC à¹ƒà¸«à¸¡à¹ˆà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™: ${epcName}`,
  { epcId: result.insertId, epcName, taxId }
);
sendNotificationToAdmins(notification);
```

## API Reference

### Backend - Socket Events

#### Server-side Events
```javascript
// à¸ªà¹ˆà¸‡à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹„à¸›à¸¢à¸±à¸‡ Admin room
sendNotificationToAdmins(notification)

// à¸ªà¸£à¹‰à¸²à¸‡ notification object
createNotification(type, message, data)
```

#### Client-side Events
```javascript
// à¸£à¸±à¸šà¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™
socket.on('notification', (notification) => {
  // Handle notification
})

// à¸ªà¹ˆà¸‡à¸ªà¸±à¸à¸à¸²à¸“à¸§à¹ˆà¸²à¸­à¹ˆà¸²à¸™à¹à¸¥à¹‰à¸§
socket.emit('notification:read', notificationId)
```

### Frontend - useNotifications Hook

```javascript
const {
  notifications,      // Array of notifications
  unreadCount,        // Number of unread notifications
  isConnected,        // Socket connection status
  markAsRead,         // Mark single notification as read
  markAllAsRead,      // Mark all as read
  clearAll,           // Clear all notifications
  deleteNotification  // Delete specific notification
} = useNotifications();
```

## Notification Types

```javascript
const NotificationTypes = {
  USER_LOGIN: 'user_login',
  USER_REGISTER: 'user_register',
  EPC_REGISTER: 'epc_register',
  AGENCY_REGISTER: 'agency_register',
  COORDINATOR_REGISTER: 'coordinator_register',
  PROJECT_REGISTER: 'project_register',
  APPROVAL_REQUEST: 'approval_request'
};
```

## à¸à¸²à¸£à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡

### à¹€à¸à¸´à¹ˆà¸¡ Notification Type à¹ƒà¸«à¸¡à¹ˆ

1. **à¹€à¸à¸´à¹ˆà¸¡à¹ƒà¸™ Backend (socket.js):**
```javascript
const NotificationTypes = {
  // ... existing types
  YOUR_NEW_TYPE: 'your_new_type'
};
```

2. **à¹€à¸à¸´à¹ˆà¸¡à¹„à¸­à¸„à¸­à¸™à¹ƒà¸™ Frontend (NotificationBell.jsx):**
```javascript
const getNotificationIcon = (type) => {
  const icons = {
    // ... existing icons
    your_new_type: 'ğŸ†•'
  };
  return icons[type] || 'ğŸ””';
};
```

3. **à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹ƒà¸™ Route:**
```javascript
const notification = createNotification(
  NotificationTypes.YOUR_NEW_TYPE,
  'Your notification message',
  { /* your data */ }
);
sendNotificationToAdmins(notification);
```

## Security

- âœ… Socket connections à¸•à¹‰à¸­à¸‡à¸¡à¸µ JWT token
- âœ… Admin role verification
- âœ… à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸‰à¸à¸²à¸° Admin room à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- âœ… Token verification à¸—à¸µà¹ˆ socket middleware

## Troubleshooting

### à¸›à¸±à¸à¸«à¸²: Socket à¹„à¸¡à¹ˆà¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­
**à¸§à¸´à¸˜à¸µà¹à¸à¹‰:**
1. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² backend server à¸£à¸±à¸™à¸­à¸¢à¸¹à¹ˆ
2. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸¡à¸µ JWT token à¹ƒà¸™ localStorage
3. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š CORS settings
4. à¸”à¸¹ console log à¸ªà¸³à¸«à¸£à¸±à¸š error messages

### à¸›à¸±à¸à¸«à¸²: à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸£à¸±à¸š notification
**à¸§à¸´à¸˜à¸µà¹à¸à¹‰:**
1. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² user role à¹€à¸›à¹‡à¸™ 'admin'
2. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² socket connected (à¸ˆà¸¸à¸”à¸ªà¸µà¹€à¸‚à¸µà¸¢à¸§)
3. à¸”à¸¹ network tab à¹ƒà¸™ browser devtools
4. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š backend logs

### à¸›à¸±à¸à¸«à¸²: Notification à¸‹à¹‰à¸³
**à¸§à¸´à¸˜à¸µà¹à¸à¹‰:**
1. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹„à¸¡à¹ˆà¸¡à¸µ multiple socket connections
2. Clear localStorage à¹à¸¥à¸° login à¹ƒà¸«à¸¡à¹ˆ

## Environment Variables

**Backend:**
- `JWT_SECRET` - JWT secret key à¸ªà¸³à¸«à¸£à¸±à¸š authentication
- `PORT` - Backend server port (default: 5000)

**Frontend:**
- `VITE_API_BASE_URL` - Backend API URL

## Performance

- âœ… Efficient connection management
- âœ… Auto-reconnection on disconnect
- âœ… Minimal payload size
- âœ… Room-based broadcasting (à¹à¸ˆà¹‰à¸‡à¹€à¸‰à¸à¸²à¸° Admin)

## Future Enhancements

- ğŸ”² à¹€à¸à¹‡à¸š notifications à¹ƒà¸™ database
- ğŸ”² Notification history page
- ğŸ”² Push notifications
- ğŸ”² Email notifications
- ğŸ”² Notification preferences/settings
- ğŸ”² Sound alerts
- ğŸ”² Different notification priorities

## à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š

### à¸—à¸”à¸ªà¸­à¸šà¸£à¸°à¸šà¸š:
1. à¹€à¸›à¸´à¸” 2 browser tabs
2. Login à¹€à¸›à¹‡à¸™ Admin à¹ƒà¸™ tab 1
3. Login/Register à¹ƒà¸«à¸¡à¹ˆà¹ƒà¸™ tab 2
4. Tab 1 (Admin) à¸ˆà¸°à¹„à¸”à¹‰à¸£à¸±à¸šà¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸—à¸±à¸™à¸—à¸µ

### à¸—à¸”à¸ªà¸­à¸š notification types:
- Login à¸”à¹‰à¸§à¸¢ user à¹ƒà¸«à¸¡à¹ˆ
- à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™ EPC à¹ƒà¸«à¸¡à¹ˆ
- à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸«à¸™à¹ˆà¸§à¸¢à¸‡à¸²à¸™à¹ƒà¸«à¸¡à¹ˆ
- à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™ Sale/Coordinator à¹ƒà¸«à¸¡à¹ˆ

## Support

à¸«à¸²à¸à¸¡à¸µà¸›à¸±à¸à¸«à¸²à¸«à¸£à¸·à¸­à¸‚à¹‰à¸­à¸ªà¸‡à¸ªà¸±à¸¢:
1. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š console logs (F12)
2. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š network tab
3. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š backend logs
4. à¸”à¸¹à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¹ƒà¸™ code comments

---

**Created:** November 2025  
**Version:** 1.0.0  
**Status:** âœ… Production Ready


